!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Sidebar={})}(this,(function(e){"use strict";function t(e){const t=e.querySelectorAll(":scope > * > .sidebar-row"),s=Array.from(t).reduce(((e,t)=>e+t.clientHeight),0);return e.clientHeight-s}function s(e){const t=e.querySelectorAll(":scope > * > .sidebar-row.row-collapsable:not(.row-collapsed)");return t[t.length-1]}function n(e,n){!function(e,n){if(e.classList.contains("sidebar-expanded"))return;let i=t(e);for(;i<n;){const n=s(e);if(!n)break;n.classList.add("row-collapsed"),i=t(e)}}(e,n),function(e,s){if(e.classList.contains("sidebar-expanded"))return;const n=e.querySelectorAll(":scope > * > .sidebar-row.row-collapsable.row-collapsed");let i=t(e);for(const o of n)i>=s&&o.classList.remove("row-collapsed"),i=t(e)}(e,n),function(e){const t=e.querySelector(".sidebar-collapsed-button");t&&(e.querySelectorAll(":scope > * > .sidebar-row.row-collapsable.row-collapsed").length>0?t.classList.add("collapsable-rows-exist"):t.classList.remove("collapsable-rows-exist"))}(e)}class i extends EventTarget{get expanded(){return this._expanded}get options(){return this._options}constructor(e,t=null){super(),this.items=[],this.footerItems=[],this._expanded=!1,this._options={userCanOpenDropdowns:!0,autoOpenDropdownsOnExpand:!1,autoCloseDropdownsOnMinimize:!0,closeOtherDropdownsOnOpen:!0,expandOnDropdownClick:!0,expandOnMouseEnter:!1,minimizeOnMouseLeave:!1},this.element=e,t&&(this._options=Object.assign(Object.assign({},this._options),t))}static fromHTML(e,t=null){const s=new i(e,t);return s.instantiateFromHtml(),s.attachEventListeners(),s}instantiateFromHtml(){const e=this.element.querySelector(".sidebar-content"),t=this.element.querySelector(".sidebar-footer"),s=this.element.querySelector(".sidebar-toggle-button"),n=this.element.querySelector(".sidebar-collapsed-button");if(e)for(const t of e.children)t!=s&&t!=n&&this.items.push(d.createItemFromHtml(t));if(t)for(const e of t.children)this.footerItems.push(d.createItemFromHtml(e))}createToggleButton(){const e=document.createElement("div");e.classList.add("sidebar-row","sidebar-toggle-button");const t=document.createElement("div");t.classList.add("sidebar-item");const s=document.createElement("span");s.classList.add("sidebar-icon"),t.appendChild(s);const n=document.createElement("i");return n.classList.add("bi-arrow-right"),s.appendChild(n),e.appendChild(t),e}createCollapsedButton(){const e=document.createElement("div");e.classList.add("sidebar-row","sidebar-collapsed-button");const t=document.createElement("div");t.classList.add("sidebar-item");const s=document.createElement("span");s.classList.add("sidebar-icon"),t.appendChild(s);const n=document.createElement("i");return n.classList.add("bi-three-dots"),s.appendChild(n),e.appendChild(t),e}createContentContainer(){const e=document.createElement("div");return e.classList.add("sidebar-content"),e}createFooterContainer(){const e=document.createElement("div");return e.classList.add("sidebar-footer"),e}toggle(){this._expanded?this.minimize():this.expand()}expand(){this.element.classList.remove("sidebar-minimized"),this.element.classList.add("sidebar-expanded");const e=this.element.querySelector(".sidebar-content");if(e&&(e.scrollTop=0),this.options.autoOpenDropdownsOnExpand){const e=this.element.getElementsByClassName("sidebar-row");for(const t of e)t.classList.contains("sidebar-row-dropdown")&&t.classList.add("group-opened")}this._expanded=!0,this.dispatchEvent(new Event("expanded"))}minimize(){if(this.element.classList.remove("sidebar-expanded"),this.element.classList.add("sidebar-minimized"),this.options.autoCloseDropdownsOnMinimize){const e=this.element.querySelectorAll(".group-opened");for(const t of e)t.classList.remove("group-opened")}this._expanded=!1,this.dispatchEvent(new Event("minimized"))}addLink(e,t,s){const n=new a(e,t,s);return this.items.push(n),n}addDropdown(e,t){const s=new r(e,t);return this.items.push(s),s}addFooterLink(e,t,s){const n=new a(e,t,s);return this.footerItems.push(n),n}addFooterDropdown(e,t){const s=new r(e,t);return this.footerItems.push(s),s}render(){if(this.element.innerHTML="",this.element.classList.add("sidebar"),this.element.classList.contains("sidebar-expanded")||this.element.classList.add("sidebar-minimized"),this.element.setAttribute("data-bs-theme","dark"),this.items.length>0){const e=this.createContentContainer();this.element.appendChild(e);const t=this.createToggleButton();e.appendChild(t),this.items.forEach((t=>{t.render(e,this)}));const s=this.createCollapsedButton();e.appendChild(s)}if(this.footerItems.length>0){const e=this.createFooterContainer();this.element.appendChild(e),this.footerItems.forEach((t=>{t.render(e,this)}))}this.attachEventListeners(),this.element.classList.add("sidebar-loaded")}attachEventListeners(){c.attachEventListeners(this)}}class o{constructor(e,t=null,s=null){this.active=!1,this.name=e,this.href=t,this.iconClass=s}static fromHtml(e){throw new Error("Static method meant as abstract was called: SidebarItem.fromHtml()")}static isOfType(e){throw new Error("Static method meant as abstract was called: SidebarItem.isOfType()")}static attachEventListeners(e){throw new Error("Static method meant as abstract was called: SidebarItem.attachEventListeners()")}}class a extends o{constructor(e,t,s){super(e,t,s)}render(e,t){if(e.parentElement.classList.contains("sidebar")){const t=this.createRow("a");e.appendChild(t),e.classList.contains("sidebar-content")&&t.classList.add("row-collapsable");const s=this.createItem("div");t.appendChild(s);const n=this.createIcon();s.appendChild(n);const i=this.createText();s.appendChild(i);const o=this.createItemGroup();t.appendChild(o);const a=this.createGroupTitle();o.appendChild(a);const r=this.createIcon(!0);a.appendChild(r);const d=this.createText();a.appendChild(d)}else{const t=this.createItem("a");e.appendChild(t);const s=this.createIcon();t.appendChild(s);const n=this.createText();t.appendChild(n)}}static fromHtml(e){var t,s,n,i;if(e.classList.contains("sidebar-row")){const i=null===(t=e.querySelector(":scope > .sidebar-item"))||void 0===t?void 0:t.getAttribute("title"),o=e.getAttribute("href"),r=null===(s=e.querySelector(":scope > .sidebar-item > .sidebar-icon > i"))||void 0===s?void 0:s.getAttribute("class"),d=null===(n=e.querySelector(":scope > .sidebar-item"))||void 0===n?void 0:n.classList.contains("item-active");if(i&&o&&r){const e=new a(i,o,r);return d&&(e.active=d),e}}else if(e.classList.contains("sidebar-item")){const t=e.getAttribute("title"),s=e.getAttribute("href");let n=null===(i=e.querySelector(":scope > .sidebar-item > .sidebar-icon > i"))||void 0===i?void 0:i.getAttribute("class");if(n||(n=null),t&&s){return new a(t,s,n)}}}static isOfType(e){const t=e.classList;return!(!t.contains("sidebar-row")&&!t.contains("sidebar-item")||t.contains("sidebar-row-dropdown")||t.contains("sidebar-toggle-button"))}static attachEventListeners(e){}createRow(e){const t=document.createElement(e);return t.classList.add("sidebar-row"),"a"===e&&(t.href=this.href),t}createItem(e){const t=document.createElement(e);return t.classList.add("sidebar-item"),this.active&&t.classList.add("item-active"),"a"===e&&(t.href=this.href),t.title=this.name,t}createIcon(e=!1){const t=document.createElement("span");t.classList.add("sidebar-icon");const s=document.createElement("i");return this.iconClass&&!e&&s.classList.add(...this.iconClass.split(" ")),t.appendChild(s),t}createText(){const e=document.createElement("span");return e.classList.add("sidebar-text"),e.innerHTML=this.name,e}createItemGroup(){const e=document.createElement("div");return e.classList.add("sidebar-item-group"),e}createGroupTitle(){const e=document.createElement("div");return e.classList.add("sidebar-item","group-title"),e}}class r extends o{constructor(e,t){super(e,null,t),this.items=[]}render(e,t){const s=this.createRow();e.appendChild(s),e.classList.contains("sidebar-content")&&s.classList.add("row-collapsable");const n=this.createItem();s.appendChild(n);const i=this.createIcon();n.appendChild(i);const o=this.createText();n.appendChild(o);const a=this.createItemGroup();s.appendChild(a);const r=this.createGroupTitle();a.appendChild(r);const d=this.createIcon(!0);r.appendChild(d);const c=this.createText();r.appendChild(c),this.items.forEach((e=>{e.render(a,t)}))}static fromHtml(e){var t,s;const n=null===(t=e.querySelector(":scope > .sidebar-item"))||void 0===t?void 0:t.getAttribute("title");let i=null===(s=e.querySelector(":scope > .sidebar-item > .sidebar-icon > i"))||void 0===s?void 0:s.getAttribute("class");if(!n)return;i||(i=null);const o=new r(n,i),a=e.querySelectorAll(":scope > .sidebar-item-group > *:not(.group-title)");for(const e of a)o.items.push(d.createItemFromHtml(e));return o}static isOfType(e){return!!e.classList.contains("sidebar-row-dropdown")}static attachEventListeners(e){const t=e.element.querySelectorAll(".sidebar-row-dropdown");e.options.userCanOpenDropdowns&&t.forEach((t=>{const s=t.querySelector(":scope > .sidebar-item");s&&s.addEventListener("click",(function(){if(e.expanded&&(t.classList.toggle("group-opened"),e.options.closeOtherDropdownsOnOpen)){Array.from(t.parentElement.querySelectorAll(".sidebar-row")).filter((e=>e!==t)).forEach((e=>{e.classList.remove("group-opened")}))}}))})),e.options.expandOnDropdownClick&&t.forEach((t=>{const s=t.querySelector(":scope > .sidebar-item");if(s){const n=t.querySelector(":scope > .sidebar-item-group"),i=s.querySelector(":scope > .sidebar-text");n&&i&&s.addEventListener("click",(function(){i.style.transition="none",n.style.transition="none",e.expanded||(e.expand(),t.classList.add("group-opened")),i.style.removeProperty("transition")}))}}))}addLink(e,t){const s=new a(e,t,null);this.items.push(s)}addDropdown(e,t=null){const s=new r(e,t);return this.items.push(s),s}createRow(){const e=document.createElement("div");return e.classList.add("sidebar-row","sidebar-row-dropdown"),e}createItem(){const e=document.createElement("div");return e.classList.add("sidebar-item"),e.setAttribute("title",this.name),e}createIcon(e=!1){const t=document.createElement("span");t.classList.add("sidebar-icon");const s=document.createElement("i");return this.iconClass&&!e&&s.classList.add(...this.iconClass.split(" ")),t.appendChild(s),t}createText(){const e=document.createElement("span");return e.classList.add("sidebar-text"),e.innerHTML=this.name,e}createItemGroup(){const e=document.createElement("div");return e.classList.add("sidebar-item-group"),e}createGroupTitle(){const e=document.createElement("div");return e.classList.add("sidebar-item","group-title"),e}}class d{static createItemFromHtml(e){let t,s="";if(a.isOfType(e)?(t=a.fromHtml(e),s="HTMLElement could not be converted to SidebarLink"):r.isOfType(e)?(t=r.fromHtml(e),s="HTMLElement could not be converted to SidebarDropdown"):s="HTMLElement does not match any SidebarItem type",!t)throw new Error(`Failed conversion of HTMLElement to SidebarItem: ${s}`);return t}}class c{static attachEventListeners(e){this.handleToggleButton(e),this.handleCollapsedButton(e),this.handleClosingWhenClickingOutside(e),this.handleOffscreenSidemenus(e),this.handleRowCollapsingBehaviour(e),this.handleExpandOnMouseEnter(e),this.handleMinimizeOnMouseLeave(e),r.attachEventListeners(e)}static handleToggleButton(e){const t=e.element.querySelector(".sidebar-toggle-button");t&&t.addEventListener("click",(()=>{e.toggle()}))}static handleCollapsedButton(e){const t=e.element.querySelector(".sidebar-collapsed-button");t&&t.addEventListener("click",(()=>{e.expand()}))}static handleClosingWhenClickingOutside(e){document.removeEventListener("click",e.handleDocumentClick),e.handleDocumentClick=t=>{!e.element.contains(t.target)&&e.expanded&&e.minimize()},document.addEventListener("click",e.handleDocumentClick)}static handleOffscreenSidemenus(e){e.element.querySelectorAll(".sidebar-item-group").forEach((t=>{t.parentElement.addEventListener("mouseenter",(s=>{t.classList.remove("prevent-offscreen-bottom"),e.expanded||function(e,t){let s=e.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight;return!(Math.floor(100-(s.top>=0?0:s.top)/+-s.height*100)<t||Math.floor(100-(s.bottom-n)/s.height*100)<t)}(t,100)||t.classList.add("prevent-offscreen-bottom")})),t.parentElement.addEventListener("mouseleave",(e=>{t.classList.remove("prevent-offscreen-bottom")}))}))}static handleRowCollapsingBehaviour(e){n(e.element,55),window.addEventListener("resize",(()=>{n(e.element,55)})),window.addEventListener("load",(()=>{n(e.element,55)})),e.addEventListener("expanded",(()=>{n(e.element,55)})),e.addEventListener("minimized",(()=>{n(e.element,55)}))}static handleExpandOnMouseEnter(e){e.options.expandOnMouseEnter&&e.element.addEventListener("mouseenter",(()=>{e.expanded||e.expand()}))}static handleMinimizeOnMouseLeave(e){e.options.minimizeOnMouseLeave&&e.element.addEventListener("mouseleave",(()=>{e.expanded&&e.minimize()}))}}e.Sidebar=i}));
