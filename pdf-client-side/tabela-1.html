<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>

    <link rel="stylesheet" href="assets/css/style.css" />
    <script src="assets/js/jspdf/dist/jspdf.umd.min.js"></script>
</head>

<body>
    <input type="button" value="PDF" onclick="gerar()" />

    <script>
        const Employee = [{
                ID: 1,
                Name: "Airi Satou",
                Position: "Accountant",
                Office: "Tokyo",
                Age: 33,
                Start: new Date("2008-11-28"),
                Salary: 162.7,
            },
            {
                ID: 2,
                Name: "Angelica Ramos",
                Position: "Chief Executive Officer (CEO)",
                Office: "London",
                Age: 47,
                Start: new Date("2009-10-09"),
                Salary: 1200.0,
            },
            {
                ID: 3,
                Name: "Ashton Cox",
                Position: "Junior Technical Author",
                Office: "San Francisco",
                Age: 66,
                Start: new Date("2009-01-12"),
                Salary: 86.0,
            },
            {
                ID: 4,
                Name: "Bradley Greer",
                Position: "Software Engineer",
                Office: "London",
                Age: 41,
                Start: new Date("2012-10-13"),
                Salary: 132.0,
            },
            {
                ID: 5,
                Name: "Brenden Wagner",
                Position: "Software Engineer",
                Office: "San Francisco",
                Age: 28,
                Start: new Date("2011-06-07"),
                Salary: 206.85,
            },
            {
                ID: 6,
                Name: "Brielle Williamson",
                Position: "Integration Specialist",
                Office: "New York",
                Age: 61,
                Start: new Date("2012-12-02"),
                Salary: 372.0,
            },
            {
                ID: 7,
                Name: "Bruno Nash",
                Position: "Software Engineer",
                Office: "London",
                Age: 38,
                Start: new Date("2011-05-03"),
                Salary: 163.5,
            },
            {
                ID: 8,
                Name: "Caesar Vance",
                Position: "Pre-Sales Support",
                Office: "New York",
                Age: 21,
                Start: new Date("2011-12-12"),
                Salary: 106.45,
            },
            {
                ID: 9,
                Name: "Cara Stevens",
                Position: "Sales Assistant",
                Office: "New York",
                Age: 46,
                Start: new Date("2011-12-06"),
                Salary: 145.6,
            },
            {
                ID: 10,
                Name: "Cedric Kelly",
                Position: "Senior Javascript Developer",
                Office: "Edinburgh",
                Age: 22,
                Start: new Date("2012-03-29"),
                Salary: 433.06,
            },
            {
                ID: 11,
                Name: "Charde Marshall",
                Position: "Regional Director",
                Office: "San Francisco",
                Age: 36,
                Start: new Date("2008-10-16"),
                Salary: 470.6,
            },
            {
                ID: 12,
                Name: "Colleen Hurst",
                Position: "Javascript Developer",
                Office: "San Francisco",
                Age: 39,
                Start: new Date("2009-09-15"),
                Salary: 205.5,
            },
            {
                ID: 13,
                Name: "Dai Rios",
                Position: "Personnel Lead",
                Office: "Edinburgh",
                Age: 35,
                Start: new Date("2012-09-26"),
                Salary: 217.5,
            },
            {
                ID: 14,
                Name: "Donna Snider",
                Position: "Customer Support",
                Office: "New York",
                Age: 27,
                Start: new Date("2011-01-25"),
                Salary: 112.0,
            },
            {
                ID: 15,
                Name: "Doris Wilder",
                Position: "Sales Assistant",
                Office: "Sydney",
                Age: 23,
                Start: new Date("2010-09-20"),
                Salary: 85.6,
            },
            {
                ID: 16,
                Name: "Finn Camacho",
                Position: "Support Engineer",
                Office: "San Francisco",
                Age: 47,
                Start: new Date("2009-07-07"),
                Salary: 87.5,
            },
            {
                ID: 17,
                Name: "Fiona Green",
                Position: "Chief Operating Officer (COO)",
                Office: "San Francisco",
                Age: 48,
                Start: new Date("2010-03-11"),
                Salary: 850.0,
            },
            {
                ID: 18,
                Name: "Garrayett Winters",
                Position: "Accountant",
                Office: "Tokyo",
                Age: 63,
                Start: new Date("2011-07-25"),
                Salary: 170.75,
            },
            {
                ID: 19,
                Name: "Gavin Cortez",
                Position: "Team Leader",
                Office: "San Francisco",
                Age: 22,
                Start: new Date("2008-10-26"),
                Salary: 235.5,
            },
            {
                ID: 20,
                Name: "Gavin Joyce",
                Position: "Developer",
                Office: "Edinburgh",
                Age: 42,
                Start: new Date("2010-12-22"),
                Salary: 92.57,
            },
            {
                ID: 21,
                Name: "Gloria Little",
                Position: "Systems Administrator",
                Office: "New York",
                Age: 59,
                Start: new Date("2009-04-10"),
                Salary: 237.5,
            },
            {
                ID: 22,
                Name: "Haley Kennedy",
                Position: "Senior Marketing Designer",
                Office: "London",
                Age: 43,
                Start: new Date("2012-12-18"),
                Salary: 313.5,
            },
            {
                ID: 23,
                Name: "Hermione Butler",
                Position: "Regional Director",
                Office: "London",
                Age: 47,
                Start: new Date("2011-03-21"),
                Salary: 356.25,
            },
            {
                ID: 24,
                Name: "Herrod Chandler",
                Position: "Sales Assistant",
                Office: "San Francisco",
                Age: 59,
                Start: new Date("2012-08-06"),
                Salary: 137.5,
            },
            {
                ID: 25,
                Name: "Hope Fuentes",
                Position: "Secretary",
                Office: "San Francisco",
                Age: 41,
                Start: new Date("2010-02-12"),
                Salary: 109.85,
            },
            {
                ID: 26,
                Name: "Howard Hatfield",
                Position: "Office Manager",
                Office: "San Francisco",
                Age: 51,
                Start: new Date("2008-12-16"),
                Salary: 164.5,
            },
            {
                ID: 27,
                Name: "Jackson Bradshaw",
                Position: "Director",
                Office: "New York",
                Age: 65,
                Start: new Date("2008-09-26"),
                Salary: 645.75,
            },
            {
                ID: 28,
                Name: "Jena Gaines",
                Position: "Office Manager",
                Office: "London",
                Age: 30,
                Start: new Date("2008-12-19"),
                Salary: 90.56,
            },
            {
                ID: 29,
                Name: "Jenette Caldwell",
                Position: "Development Lead",
                Office: "New York",
                Age: 30,
                Start: new Date("2011-09-03"),
                Salary: 345.0,
            },
            {
                ID: 30,
                Name: "Jennifer Acosta",
                Position: "Junior Javascript Developer",
                Office: "Edinburgh",
                Age: 43,
                Start: new Date("2013-02-01"),
                Salary: 75.65,
            },
        ];

        /* ------------------------------
            ! Implementação
        ------------------------------ */

        function gerar() {
            const preencherCelula = function (obj) {
                let array = new Array();

                for (let i = 0; i < obj.length; i += 1) {
                    array.push({
                        ID: obj[i].ID.toString(),
                        Name: obj[i].Name,
                        Position: obj[i].Position,
                        Office: obj[i].Office,
                        Age: obj[i].Age.toString(),
                        Start: obj[i].Start.toLocaleDateString("en-US"),
                        Salary: obj[i].Salary.toLocaleString("en-US", {
                            style: "currency",
                            currency: "USD",
                        }),
                    });
                }

                return array;
            };

            function criarColuna(keys) {
                let array = new Array();

                for (let i = 0; i < keys.length; i += 1) {
                    if (keys[i].includes("Name") || keys[i].includes("Position")) {
                        array.push({
                            id: keys[i],
                            name: keys[i],
                            prompt: keys[i],
                            width: 86.5,
                            align: "center",
                            padding: 0,
                        });
                    }

                    if (keys[i].includes("Age")) {
                        array.push({
                            id: keys[i],
                            name: keys[i],
                            prompt: keys[i],
                            width: 20,
                            align: "center",
                            padding: 0,
                        });
                    }

                    array.push({
                        id: keys[i],
                        name: keys[i],
                        prompt: keys[i],
                        width: 50,
                        align: "center",
                        padding: 0,
                    });
                }

                return array;
            }

            const titulos = criarColuna([
                "ID",
                "Name",
                "Position",
                "Office",
                "Age",
                "Start",
                "Salary",
            ]);

            const doc = new window.jspdf.jsPDF({
                putOnlyUsedFonts: true,
                orientation: "landscape",
            });

            doc.table(1, 1, preencherCelula(Employee), titulos, {
                autoSize: false,
            });

            doc.save("demo.pdf");
        }
    </script>
</body>

</html>